local UI_Module = {}
local TweenService = game:GetService("TweenService")

function UI_Module.CreateMain(hubTitle)
	local Library = {}
	
	local ScreenGui = Instance.new("ScreenGui")
	ScreenGui.Name = "GeminiRedux_UI"
	ScreenGui.Parent = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui")
	ScreenGui.ResetOnSpawn = false

	-- Главное окно
	local Main = Instance.new("Frame")
	Main.Name = "Main"
	Main.Size = UDim2.new(0, 600, 0, 400)
	Main.Position = UDim2.new(0.5, -300, 0.5, -200)
	Main.BackgroundColor3 = Color3.fromRGB(18, 18, 20)
	Main.BorderSizePixel = 0
	Main.Parent = ScreenGui

	Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 10)
	local MainStroke = Instance.new("UIStroke")
	MainStroke.Thickness = 1.2
	MainStroke.Color = Color3.fromRGB(40, 40, 45)
	MainStroke.Parent = Main

	-- Сайдбар (Скроллинг слева)
	local Sidebar = Instance.new("ScrollingFrame")
	Sidebar.Name = "Sidebar"
	Sidebar.Size = UDim2.new(0, 160, 1, -20)
	Sidebar.Position = UDim2.new(0, 10, 0, 10)
	Sidebar.BackgroundTransparency = 1
	Sidebar.ScrollBarThickness = 0 -- Невидимый скролл для красоты
	Sidebar.CanvasSize = UDim2.new(0, 0, 0, 0)
	Sidebar.Parent = Main

	local SideLayout = Instance.new("UIListLayout")
	SideLayout.Padding = UDim.new(0, 6)
	SideLayout.Parent = Sidebar
	SideLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		Sidebar.CanvasSize = UDim2.new(0, 0, 0, SideLayout.AbsoluteContentSize.Y)
	end)

	-- Контейнер для страниц
	local PageContainer = Instance.new("Frame")
	PageContainer.Name = "PageContainer"
	PageContainer.Size = UDim2.new(1, -190, 1, -20)
	PageContainer.Position = UDim2.new(0, 180, 0, 10)
	PageContainer.BackgroundTransparency = 1
	PageContainer.Parent = Main

	local CurrentTab = nil

	-- МЕТОД СОЗДАНИЯ ВКЛАДКИ
	function Library:CreateTab(name)
		local TabElements = {}
		
		-- Кнопка в меню
		local TabBtn = Instance.new("TextButton")
		TabBtn.Size = UDim2.new(1, -5, 0, 34)
		TabBtn.BackgroundColor3 = Color3.fromRGB(25, 25, 28)
		TabBtn.Text = name
		TabBtn.TextColor3 = Color3.fromRGB(160, 160, 165)
		TabBtn.Font = Enum.Font.GothamMedium
		TabBtn.TextSize = 13
		TabBtn.Parent = Sidebar
		
		Instance.new("UICorner", TabBtn).CornerRadius = UDim.new(0, 6)
		local BtnStroke = Instance.new("UIStroke")
		BtnStroke.Color = Color3.fromRGB(45, 45, 50)
		BtnStroke.Parent = TabBtn

		-- Сама страница (Скроллинг справа)
		local Page = Instance.new("ScrollingFrame")
		Page.Name = name .. "_Page"
		Page.Size = UDim2.new(1, 0, 1, 0)
		Page.BackgroundTransparency = 1
		Page.Visible = false
		Page.ScrollBarThickness = 2
		Page.ScrollBarImageColor3 = Color3.fromRGB(60, 60, 65)
		Page.Parent = PageContainer

		local PageLayout = Instance.new("UIListLayout")
		PageLayout.Padding = UDim.new(0, 10)
		PageLayout.Parent = Page
		PageLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
			Page.CanvasSize = UDim2.new(0, 0, 0, PageLayout.AbsoluteContentSize.Y + 10)
		end)

		-- Авто-заголовок
		local Title = Instance.new("TextLabel")
		Title.Size = UDim2.new(1, 0, 0, 35)
		Title.Text = name
		Title.TextColor3 = Color3.fromRGB(255, 255, 255)
		Title.Font = Enum.Font.GothamBold
		Title.TextSize = 20
		Title.TextXAlignment = Enum.TextXAlignment.Left
		Title.BackgroundTransparency = 1
		Title.Parent = Page

		-- Логика переключения
		TabBtn.MouseButton1Click:Connect(function()
			for _, p in pairs(PageContainer:GetChildren()) do p.Visible = false end
			for _, b in pairs(Sidebar:GetChildren()) do
				if b:IsA("TextButton") then
					TweenService:Create(b, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(25, 25, 28), TextColor3 = Color3.fromRGB(160, 160, 165)}):Play()
				end
			end
			Page.Visible = true
			TweenService:Create(TabBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(45, 45, 180), TextColor3 = Color3.fromRGB(255, 255, 255)}):Play()
		end)

		-- Если это первая вкладка - открываем её сразу
		if not CurrentTab then
			CurrentTab = Page
			Page.Visible = true
			TabBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 180)
			TabBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
		end

		--- ЭЛЕМЕНТЫ СТРАНИЦЫ ---

		-- 1. Текст с кнопкой справа
		function TabElements:AddButton(text, btnText, callback)
			local Frame = Instance.new("Frame")
			Frame.Size = UDim2.new(1, -10, 0, 40)
			Frame.BackgroundColor3 = Color3.fromRGB(22, 22, 25)
			Frame.Parent = Page
			Instance.new("UICorner", Frame)
			Instance.new("UIStroke", Frame).Color = Color3.fromRGB(35,35,40)

			local Lbl = Instance.new("TextLabel")
			Lbl.Size = UDim2.new(0.7, 0, 1, 0)
			Lbl.Position = UDim2.new(0, 12, 0, 0)
			Lbl.BackgroundTransparency = 1
			Lbl.Text = text
			Lbl.TextColor3 = Color3.fromRGB(200, 200, 205)
			Lbl.Font = Enum.Font.Gotham
			Lbl.TextXAlignment = Enum.TextXAlignment.Left
			Lbl.Parent = Frame

			local Btn = Instance.new("TextButton")
			Btn.Size = UDim2.new(0.25, 0, 0, 26)
			Btn.Position = UDim2.new(0.72, 0, 0.5, -13)
			Btn.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
			Btn.Text = btnText
			Btn.TextColor3 = Color3.fromRGB(255,255,255)
			Btn.Font = Enum.Font.GothamBold
			Btn.Parent = Frame
			Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 4)
			
			Btn.MouseButton1Click:Connect(callback)
		end

		-- 2. Текст с кнопкой + Scrolling Frame снизу
		function TabElements:AddComplex(text, btnText, height, callback)
			local Container = Instance.new("Frame")
			Container.Size = UDim2.new(1, -10, 0, 45 + height)
			Container.BackgroundColor3 = Color3.fromRGB(22, 22, 25)
			Container.Parent = Page
			Instance.new("UICorner", Container)

			local Lbl = Instance.new("TextLabel")
			Lbl.Size = UDim2.new(0.7, 0, 0, 40)
			Lbl.Position = UDim2.new(0, 12, 0, 0)
			Lbl.BackgroundTransparency = 1
			Lbl.Text = text
			Lbl.TextColor3 = Color3.fromRGB(200, 200, 205)
			Lbl.Font = Enum.Font.Gotham
			Lbl.TextXAlignment = Enum.TextXAlignment.Left
			Lbl.Parent = Container

			local Btn = Instance.new("TextButton")
			Btn.Size = UDim2.new(0.25, 0, 0, 26)
			Btn.Position = UDim2.new(0.72, 0, 0, 7)
			Btn.BackgroundColor3 = Color3.fromRGB(45, 120, 45)
			Btn.Text = btnText
			Btn.TextColor3 = Color3.new(1,1,1)
			Btn.Parent = Container
			Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 4)

			local SubScroll = Instance.new("ScrollingFrame")
			SubScroll.Size = UDim2.new(1, -20, 0, height - 10)
			SubScroll.Position = UDim2.new(0, 10, 0, 40)
			SubScroll.BackgroundColor3 = Color3.fromRGB(15, 15, 17)
			SubScroll.ScrollBarThickness = 2
			SubScroll.Parent = Container
			Instance.new("UICorner", SubScroll)
			
			local SubLayout = Instance.new("UIListLayout")
			SubLayout.Padding = UDim.new(0, 2)
			SubLayout.Parent = SubScroll

			Btn.MouseButton1Click:Connect(function() callback(SubScroll) end)
		end

		-- 3. Обычный текст
		function TabElements:AddLabel(text)
			local Lbl = Instance.new("TextLabel")
			Lbl.Size = UDim2.new(1, -10, 0, 20)
			Lbl.BackgroundTransparency = 1
			Lbl.Text = text
			Lbl.TextColor3 = Color3.fromRGB(150, 150, 155)
			Lbl.Font = Enum.Font.Gotham
			Lbl.TextSize = 13
			Lbl.TextXAlignment = Enum.TextXAlignment.Left
			Lbl.Parent = Page
		end

		return TabElements
	end

	return Library
end

return UI_Module
