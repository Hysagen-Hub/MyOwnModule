local UI_Module = {}
local TweenService = game:GetService("TweenService")

function UI_Module.CreateMain(hubTitle)
	local ScreenGui = Instance.new("ScreenGui")
	ScreenGui.Name = "CustomAdvancedGUI"
	ScreenGui.Parent = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui")
	ScreenGui.ResetOnSpawn = false

	-- Главный контейнер
	local MainFrame = Instance.new("Frame")
	MainFrame.Name = "MainFrame"
	MainFrame.Size = UDim2.new(0, 650, 0, 420)
	MainFrame.Position = UDim2.new(0.5, -325, 0.5, -210)
	MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 17)
	MainFrame.BorderSizePixel = 0
	MainFrame.Parent = ScreenGui

	Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 12)
	local MainStroke = Instance.new("UIStroke")
	MainStroke.Color = Color3.fromRGB(45, 45, 50)
	MainStroke.Thickness = 1.5
	MainStroke.Parent = MainFrame

	-- Левая панель (Скролл-меню вкладок)
	local SidebarContainer = Instance.new("Frame")
	SidebarContainer.Size = UDim2.new(0, 170, 1, 0)
	SidebarContainer.BackgroundColor3 = Color3.fromRGB(20, 20, 23)
	SidebarContainer.BorderSizePixel = 0
	SidebarContainer.Parent = MainFrame
	Instance.new("UICorner", SidebarContainer).CornerRadius = UDim.new(0, 12)

	local SidebarScroll = Instance.new("ScrollingFrame")
	SidebarScroll.Size = UDim2.new(1, -10, 1, -60)
	SidebarScroll.Position = UDim2.new(0, 5, 0, 50)
	SidebarScroll.BackgroundTransparency = 1
	SidebarScroll.ScrollBarThickness = 2
	SidebarScroll.ScrollBarImageColor3 = Color3.fromRGB(60, 60, 65)
	SidebarScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
	SidebarScroll.Parent = SidebarContainer

	local SideLayout = Instance.new("UIListLayout")
	SideLayout.Padding = UDim.new(0, 4)
	SideLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
	SideLayout.Parent = SidebarScroll
	
	SideLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
		SidebarScroll.CanvasSize = UDim2.new(0, 0, 0, SideLayout.AbsoluteContentSize.Y)
	end)

	local HubLabel = Instance.new("TextLabel")
	HubLabel.Size = UDim2.new(1, 0, 0, 50)
	HubLabel.Text = hubTitle
	HubLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	HubLabel.Font = Enum.Font.GothamBold
	HubLabel.TextSize = 18
	HubLabel.BackgroundTransparency = 1
	HubLabel.Parent = SidebarContainer

	-- Правая панель (Контейнер страниц)
	local PagesFolder = Instance.new("Frame")
	PagesFolder.Size = UDim2.new(1, -180, 1, -10)
	PagesFolder.Position = UDim2.new(0, 175, 0, 5)
	PagesFolder.BackgroundTransparency = 1
	PagesFolder.Parent = MainFrame

	local Tabs = {}
	local FirstTab = nil

	function UI_Module:CreateTab(tabName)
		local PageScroll = Instance.new("ScrollingFrame")
		PageScroll.Name = tabName .. "_Tab"
		PageScroll.Size = UDim2.new(1, 0, 1, 0)
		PageScroll.BackgroundTransparency = 1
		PageScroll.Visible = false
		PageScroll.ScrollBarThickness = 3
		PageScroll.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 90)
		PageScroll.Parent = PagesFolder

		local PageLayout = Instance.new("UIListLayout")
		PageLayout.Padding = UDim.new(0, 8)
		PageLayout.SortOrder = Enum.SortOrder.LayoutOrder
		PageLayout.Parent = PageScroll

		PageLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
			PageScroll.CanvasSize = UDim2.new(0, 0, 0, PageLayout.AbsoluteContentSize.Y + 10)
		end)

		-- Автоматический заголовок страницы
		local Header = Instance.new("TextLabel")
		Header.Size = UDim2.new(1, 0, 0, 40)
		Header.Text = tabName
		Header.TextColor3 = Color3.fromRGB(255, 255, 255)
		Header.Font = Enum.Font.GothamBold
		Header.TextSize = 22
		Header.TextXAlignment = Enum.TextXAlignment.Left
		Header.BackgroundTransparency = 1
		Header.Parent = PageScroll

		-- Кнопка переключения в сайдбаре
		local TabBtn = Instance.new("TextButton")
		TabBtn.Size = UDim2.new(0.9, 0, 0, 35)
		TabBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
		TabBtn.Text = tabName
		TabBtn.TextColor3 = Color3.fromRGB(150, 150, 150)
		TabBtn.Font = Enum.Font.GothamMedium
		TabBtn.TextSize = 13
		TabBtn.Parent = SidebarScroll
		Instance.new("UICorner", TabBtn).CornerRadius = UDim.new(0, 6)

		TabBtn.MouseButton1Click:Connect(function()
			for _, p in pairs(PagesFolder:GetChildren()) do p.Visible = false end
			for _, b in pairs(SidebarScroll:GetChildren()) do 
				if b:IsA("TextButton") then
					TweenService:Create(b, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(30,30,35), TextColor3 = Color3.fromRGB(150,150,150)}):Play()
				end
			end
			PageScroll.Visible = true
			TweenService:Create(TabBtn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(50,50,60), TextColor3 = Color3.fromRGB(255,255,255)}):Play()
		end)

		if not FirstTab then 
			FirstTab = PageScroll 
			PageScroll.Visible = true
			TabBtn.BackgroundColor3 = Color3.fromRGB(50,50,60)
			TabBtn.TextColor3 = Color3.fromRGB(255,255,255)
		end

		local Elements = {}

		-- 1. Текст с кнопкой справа
		function Elements:AddButtonRow(title, btnText, callback)
			local Frame = Instance.new("Frame")
			Frame.Size = UDim2.new(1, -10, 0, 45)
			Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
			Frame.Parent = PageScroll
			Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 8)

			local Lbl = Instance.new("TextLabel")
			Lbl.Size = UDim2.new(0.6, 0, 1, 0)
			Lbl.Position = UDim2.new(0, 15, 0, 0)
			Lbl.Text = title
			Lbl.TextColor3 = Color3.fromRGB(200, 200, 200)
			Lbl.Font = Enum.Font.Gotham
			Lbl.TextSize = 14
			Lbl.TextXAlignment = Enum.TextXAlignment.Left
			Lbl.BackgroundTransparency = 1
			Lbl.Parent = Frame

			local Btn = Instance.new("TextButton")
			Btn.Size = UDim2.new(0.3, 0, 0, 30)
			Btn.Position = UDim2.new(0.65, 0, 0.5, -15)
			Btn.BackgroundColor3 = Color3.fromRGB(70, 80, 220)
			Btn.Text = btnText
			Btn.TextColor3 = Color3.new(1,1,1)
			Btn.Font = Enum.Font.GothamBold
			Btn.Parent = Frame
			Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 6)
			
			Btn.MouseButton1Click:Connect(callback)
		end

		-- 2. Текст с кнопкой и под-скроллом
		function Elements:AddScrollRow(title, btnText, height, callback)
			local Container = Instance.new("Frame")
			Container.Size = UDim2.new(1, -10, 0, 50 + height)
			Container.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
			Container.Parent = PageScroll
			Instance.new("UICorner", Container)

			local Lbl = Instance.new("TextLabel")
			Lbl.Size = UDim2.new(0.6, 0, 0, 50)
			Lbl.Position = UDim2.new(0, 15, 0, 0)
			Lbl.Text = title
			Lbl.TextColor3 = Color3.fromRGB(200, 200, 200)
			Lbl.Font = Enum.Font.Gotham
			Lbl.BackgroundTransparency = 1
			Lbl.TextXAlignment = Enum.TextXAlignment.Left
			Lbl.Parent = Container

			local Btn = Instance.new("TextButton")
			Btn.Size = UDim2.new(0.3, 0, 0, 30)
			Btn.Position = UDim2.new(0.65, 0, 0, 10)
			Btn.BackgroundColor3 = Color3.fromRGB(40, 150, 90)
			Btn.Text = btnText
			Btn.Parent = Container
			Instance.new("UICorner", Btn)

			local InnerScroll = Instance.new("ScrollingFrame")
			InnerScroll.Size = UDim2.new(1, -20, 0, height - 10)
			InnerScroll.Position = UDim2.new(0, 10, 0, 50)
			InnerScroll.BackgroundColor3 = Color3.fromRGB(15, 15, 18)
			InnerScroll.ScrollBarThickness = 2
			InnerScroll.Parent = Container
			Instance.new("UICorner", InnerScroll)
			
			local InnerLayout = Instance.new("UIListLayout")
			InnerLayout.Padding = UDim.new(0, 2)
			InnerLayout.Parent = InnerScroll

			Btn.MouseButton1Click:Connect(function() callback(InnerScroll) end)
			return InnerScroll
		end

		-- 3. Обычный текст
		function Elements:AddLabel(text)
			local Lbl = Instance.new("TextLabel")
			Lbl.Size = UDim2.new(1, -10, 0, 25)
			Lbl.Text = text
			Lbl.TextColor3 = Color3.fromRGB(140, 140, 150)
			Lbl.Font = Enum.Font.Gotham
			Lbl.TextSize = 13
			Lbl.BackgroundTransparency = 1
			Lbl.TextXAlignment = Enum.TextXAlignment.Left
			Lbl.Parent = PageScroll
		end

		return Elements
	end

	return UI_Module
end

return UI_Module
